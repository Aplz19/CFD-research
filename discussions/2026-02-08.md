# Discussion - February 8, 2026

## Session Summary
Completed Module A1. Finished the RHS function, built the main driver script, ran all test cases, generated error tables, created plots, and wrote the report.

## Key Topics

### RHS Function (`rhs_advection_1d.m`)
- Fixed bugs: removed accidental `U = zeros(Nx,1)` overwriting the input, added `dx` from geom
- Output variable name matched to function signature (`rhs` not `L`)

### SSPRK2 (`ssprk2.m`)
- Uses function handles (`@rhs_advection_1d`) to call the RHS function
- `@` creates a reference to a function without calling it — SSPRK calls it internally
- Argument order must match the RHS function signature (U, t, geom, params)

### Main Driver Script (`EXA1.m`)
- Nested loops over cases: smooth/non-smooth, uniform/nonuniform, varying Nx
- Grid generated inline (no grid files) — `linspace` for uniform, exponential stretching for nonuniform
- Grid struct built manually and passed to `GEOM_1D`
- Time loop marches from t=0 to T with `U = U_new` and `t = t+dt` updates each step
- `Nt = T/dt` may not be integer — noted for future improvement

### Initial Conditions
- Smooth: `U = sin(2*pi*xc)` at cell centers
- Non-smooth (top-hat): logical indexing `U(xc >= 0.25 & xc <= 0.5) = 1` on a zero-initialized vector

### Exact Solution
- Smooth: `u_exact = sin(2*pi*mod(xc - a*T, L))`
- Non-smooth: shift with `mod`, apply same logical indexing

### Error Computation
- L2 error norm: `sqrt(sum((U - u_exact).^2 .* dx))`
- Element-wise: subtract, square, weight by dx, sum, root
- Only required for smooth uniform case per the PDF

### CFL Condition
- CFL = a*dt/dx — dimensionless ratio of wave travel per step to cell width
- CFL <= 1 required for stability with explicit methods
- CFL = 1.5 causes blowup: errors grow without bound (Inf, NaN)

### Key Findings
- First-order convergence: error ~ O(dx), halves as Nx doubles
- CFL = 0.5 and 0.9 give nearly identical errors
- Error increases with T due to accumulating numerical error
- Non-smooth: numerical diffusion smears discontinuities; more cells narrows the smeared region but never achieves true sharpness
- Nonuniform grid (exponential stretching near x=0) is less accurate for these problems since features aren't clustered near x=0

## MATLAB Syntax Learned
- Function handles with `@`
- `mod()` for periodic wrapping
- Logical indexing: `U(condition) = value`
- `sum()` reduces vector to scalar
- `table()` and `writetable()` for exporting data
- `sprintf` for dynamic plot titles
- `%{ %}` for block comments, `Ctrl+R`/`Ctrl+T` for comment toggling

## Module A1 Status: COMPLETED
